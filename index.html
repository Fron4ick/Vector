<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ù–æ–≤–æ–≥–æ–¥–Ω–∏–π –ö–≤–∏–∑ 2025</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #1a2a6c; color: white; text-align: center; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px; backdrop-filter: blur(10px); }
        .round-card { cursor: pointer; background: #f39c12; margin: 10px; padding: 20px; border-radius: 10px; display: inline-block; width: 200px; transition: 0.3s; }
        .round-card:hover { transform: scale(1.05); background: #e67e22; }
        .hidden { display: none; }
        .btn { background: #27ae60; border: none; padding: 10px 20px; color: white; border-radius: 5px; cursor: pointer; margin-top: 20px; }
        .answer-box { margin-top: 15px; font-weight: bold; color: #2ecc71; font-size: 1.2em; }
        .emoji-content { font-size: 3em; margin: 20px 0; }
        .sinonim-text { font-style: italic; font-size: 1.3em; margin: 20px 0; }
        img { max-width: 100%; border-radius: 10px; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container" id="app">
    <h1>üéÑ –ù–æ–≤–æ–≥–æ–¥–Ω–∏–π –ö–≤–∏–∑ üéÑ</h1>
    
    <div id="menu">
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—É–Ω–¥:</p>
        <div id="round-list"></div>
    </div>

    <div id="game" class="hidden">
        <h2 id="round-title"></h2>
        <div id="question-container">
            <div id="content-display"></div>
            <audio id="audio-player" controls></audio>
            <div id="answer-display" class="hidden">
                <div class="answer-box" id="correct-answer"></div>
                <div id="image-display"></div>
            </div>
        </div>
        <button class="btn" id="show-answer-btn" onclick="showAnswer()">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</button>
        <button class="btn" id="next-btn" onclick="nextQuestion()">–î–∞–ª–µ–µ</button>
        <br>
        <button class="btn" style="background:#c0392b" onclick="backToMenu()">–í –º–µ–Ω—é</button>
    </div>
</div>

<script>
    let currentRoundData = null;
    let currentIndex = 0;

    // 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞—É–Ω–¥–æ–≤
    fetch('rounds_config.json')
        .then(res => res.json())
        .then(data => {
            const list = document.getElementById('round-list');
            data.forEach(round => {
                const card = document.createElement('div');
                card.className = 'round-card';
                card.innerHTML = `<h3>${round.icon} ${round.title}</h3><p>${round.description}</p>`;
                card.onclick = () => startRound(round.id);
                list.appendChild(card);
            });
        });

    // 2. –ó–∞–ø—É—Å–∫ —Ä–∞—É–Ω–¥–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ JSON
    async function startRound(roundId) {
        const fileName = roundId === 'melody' ? 'round1_melody.json' : 
                         roundId === 'emoji' ? 'round2_emoji.json' : 'round3_sinonim.json';
        
        const res = await fetch(fileName);
        currentRoundData = await res.json();
        currentIndex = 0;
        
        document.getElementById('menu').classList.add('hidden');
        document.getElementById('game').classList.remove('hidden');
        document.getElementById('round-title').innerText = currentRoundData.title;
        showQuestion();
    }

    // 3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
    function showQuestion() {
        const q = currentRoundData.questions[currentIndex];
        const display = document.getElementById('content-display');
        const audio = document.getElementById('audio-player');
        
        document.getElementById('answer-display').classList.add('hidden');
        document.getElementById('show-answer-btn').classList.remove('hidden');
        audio.pause(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—É—é –ø–µ—Å–Ω—é
        display.innerHTML = '';
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–µ–∫—Å—Ç –∏–ª–∏ —ç–º–æ–¥–∑–∏
        if (q.content) {
            display.innerHTML = `<div class="emoji-content">${q.content}</div>`;
        } else if (q.text) {
            display.innerHTML = `<div class="sinonim-text">"${q.text}"</div>`;
        }

        // –õ–û–ì–ò–ö–ê –ê–£–î–ò–û:
        // –ï—Å–ª–∏ —ç—Ç–æ —Ä–∞—É–Ω–¥ "–ú–µ–ª–æ–¥–∏–∏" (melody), –≤–∫–ª—é—á–∞–µ–º —Å—Ä–∞–∑—É
        if (currentRoundData.type === "audio") {
            audio.src = q.audio_a;
            audio.classList.remove('hidden');
            audio.play();
        } else {
            // –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—É–Ω–¥–∞—Ö –ø—Ä—è—á–µ–º –ø–ª–µ–µ—Ä –¥–æ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "–û—Ç–≤–µ—Ç"
            audio.classList.add('hidden');
            audio.src = q.audio_a; 
        }
    }

    function showAnswer() {
        const q = currentRoundData.questions[currentIndex];
        const audio = document.getElementById('audio-player');
        
        document.getElementById('correct-answer').innerText = q.answer;
        
        // –ö–∞—Ä—Ç–∏–Ω–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ JSON)
        const imgDisp = document.getElementById('image-display');
        imgDisp.innerHTML = q.image ? `<img src="${q.image}">` : ''; 
        
        // –í–ö–õ–Æ–ß–ê–ï–ú –ú–£–ó–´–ö–£ –î–õ–Ø 2 –ò 3 –†–ê–£–ù–î–ê
        if (currentRoundData.type !== "audio" && q.audio_a) {
            audio.classList.remove('hidden');
            audio.play();
        }

        document.getElementById('answer-display').classList.remove('hidden');
        document.getElementById('show-answer-btn').classList.add('hidden');
    }
    
    function nextQuestion() {
        currentIndex++;
        if (currentIndex < currentRoundData.questions.length) {
            showQuestion();
        } else {
            alert('–†–∞—É–Ω–¥ –æ–∫–æ–Ω—á–µ–Ω!');
            backToMenu();
        }
    }

    function backToMenu() {
        document.getElementById('audio-player').pause();
        document.getElementById('menu').classList.remove('hidden');
        document.getElementById('game').classList.add('hidden');
    }
</script>
</body>
</html>